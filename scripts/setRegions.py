import pandas as pd

years = {2014: {'east': {'Virginia', 'UNC', 'George Washington', 'Coastal Carolina', 'Michigan State', 'Cincinnati', 'Harvard', 'North Carolina Central', "St. Joseph's", 'Villanova', 'Memphis', 'Milwaukee', 'Delaware', 'UConn', 'Iowa State', 'Providence'}, 'midwest': {'Texas', 'Mercer', 'Duke', 'Tennessee', 'NC State', 'Wofford', 'Cal Poly', 'Michigan', 'Kansas State', 'UMass', 'Texas Southern', 'Iowa', 'Arizona State', 'Wichita State', 'Kentucky', 'Louisville', 'Xavier', 'Manhattan', 'Saint Louis'}, 'south': {'Ohio State', 'VCU', 'Colorado', 'Stanford', 'New Mexico', 'Eastern Kentucky', "Mount St. Mary's", 'Tulsa', 'Florida', 'Kansas', 'UCLA', 'Albany (NY)', 'Western Michigan', 'Stephen F. Austin', 'Dayton', 'Pitt', 'Syracuse'}, 'west': {'Creighton', 'BYU', 'Baylor', 'Oregon', 'Arizona', 'Wisconsin', 'North Dakota State', 'Gonzaga', 'San Diego State', 'Weber State', 'Nebraska', 'Oklahoma State', 'Louisiana', 'American', 'Oklahoma', 'New Mexico State'}}, 2015: {'east': {'UC-Irvine', 'Virginia', 'Georgia', 'Lafayette', 'NC State', 'Villanova', 'Albany (NY)', 'Michigan State', 'Dayton', 'Northern Iowa', 'Boise State', 'LSU', 'Louisville', 'Belmont', 'Wyoming', 'Oklahoma', 'Providence'}, 'midwest': {'Texas', 'Cincinnati', 'Northeastern', 'Butler', 'Hampton', 'Indiana', 'Maryland', 'Kansas', 'West Virginia', 'New Mexico State', 'Notre Dame', 'Valparaiso', 'Buffalo', 'Purdue', 'Kentucky', 'Wichita State', 'Manhattan'}, 'south': {'UAB', 'Duke', 'North Dakota State', 'San Diego State', 'Gonzaga', 'North Florida', 'Robert Morris', 'Iowa', 'Eastern Washington', 'UCLA', 'Davidson', 'Stephen F. Austin', 'SMU', 'Georgetown', "St. John's (NY)", 'Iowa State', 'Utah'}, 'west': {'Ohio State', 'Arkansas', 'Oregon', 'VCU', 'Arizona', 'Wofford', 'Texas Southern', 'BYU', 'UNC', 'Georgia State', 'Baylor', 'Coastal Carolina', 'Wisconsin', 'Harvard', 'Oklahoma State', 'Ole Miss', 'Xavier'}}, 2016: {'east': {'Weber State', 'Michigan', 'Tulsa', 'USC', 'Indiana', 'Chattanooga', 'West Virginia', 'UNC', 'Notre Dame', 'Stephen F. Austin', 'Fairleigh Dickinson', 'Wisconsin', 'Florida Gulf Coast', 'Pitt', 'Kentucky', 'Stony Brook', 'Xavier', 'Providence'}, 'midwest': {'Virginia', 'Texas Tech', 'Michigan State', 'Little Rock', 'Dayton', 'Gonzaga', 'Seton Hall', 'Purdue', 'Butler', 'Syracuse', 'Hampton', 'Middle Tennessee', 'Fresno State', 'Iona', 'Iowa State', 'Utah'}, 'south': {'Arizona', 'Colorado', 'Temple', 'Villanova', 'UNC Asheville', 'Maryland', 'Kansas', 'UConn', 'South Dakota State', 'Iowa', 'Hawaii', 'Buffalo', 'Vanderbilt', 'Wichita State', 'Austin Peay', 'California', 'Miami (FL)'}, 'west': {'Texas', 'Oregon', 'Texas A&M', 'Cincinnati', 'Duke', 'VCU', 'Holy Cross', 'UNC Wilmington', 'Oregon State', 'Yale', 'Baylor', 'Southern', 'Cal State Bakersfield', 'Northern Iowa', 'Green Bay', "St. Joseph's", 'Oklahoma'}}, 2017: {'east': {'Virginia', 'Duke', 'New Orleans', 'Virginia Tech', 'Villanova', 'USC', "Mount St. Mary's", 'UNC Wilmington', 'Florida', 'South Carolina', 'Troy', 'New Mexico State', 'Baylor', 'Wisconsin', 'Marquette', 'SMU', 'Providence', 'ETSU'}, 'midwest': {'Oregon', 'Michigan', 'Jacksonville State', 'Nevada', 'Kansas', 'North Carolina Central', 'Creighton', 'Michigan State', 'Louisville', 'UC-Davis', 'Purdue', 'Oklahoma State', 'Iowa State', 'Rhode Island', 'Iona', 'Vermont', 'Miami (FL)'}, 'south': {'Arkansas', 'Winthrop', 'Cincinnati', 'Butler', 'Northern Kentucky', 'Middle Tennessee', 'Kansas State', 'Seton Hall', 'Texas Southern', 'UNC', 'UCLA', 'Minnesota', 'Kent State', 'Wake Forest', 'Dayton', 'Wichita State', 'Kentucky'}, 'west': {"Saint Mary's", 'Notre Dame', 'VCU', 'Arizona', 'Florida Gulf Coast', 'Gonzaga', 'Princeton', 'Vanderbilt', 'Florida State', 'Northwestern', 'North Dakota', 'Xavier', 'Bucknell', 'South Dakota State', 'Maryland', 'West Virginia'}}, 2018: {'east': {'LIU', 'Texas Tech', 'Arkansas', 'Virginia Tech', 'Villanova', 'Butler', 'Alabama', 'Florida', 'Marshall', 'West Virginia', 'UCLA', 'Stephen F. Austin', 'Radford', 'Cal State Fullerton', 'St. Bonaventure', 'Purdue', 'Wichita State', 'Murray State'}, 'midwest': {'Duke', 'NC State', 'Auburn', 'Bucknell', 'Kansas', 'Seton Hall', 'New Mexico State', 'Arizona State', 'Penn', 'Michigan State', 'TCU', 'Clemson', 'College of Charleston', 'Syracuse', 'Rhode Island', 'Iona', 'Oklahoma'}, 'south': {'Virginia', 'Creighton', 'Texas', 'Davidson', 'Georgia State', 'Arizona', 'Buffalo', 'Cincinnati', 'Tennessee', 'Wright State', 'Kentucky', 'UMBC', 'Kansas State', 'Nevada', 'Loyola (IL)', 'Miami (FL)'}, 'west': {'Ohio State', 'Houston', 'Lipscomb', 'Texas A&M', 'Missouri', 'Gonzaga', 'San Diego State', 'Florida State', 'Michigan', 'North Carolina Central', 'Montana', 'South Dakota State', 'UNC', 'Texas Southern', 'UNC Greensboro', 'Xavier', 'Providence'}}, 2019: {'east': {'VCU', 'Duke', 'North Dakota State', 'Temple', 'Mississippi State', 'Liberty', 'Virginia Tech', 'UCF', 'North Carolina Central', 'Yale', 'Bradley', 'Minnesota', 'Michigan State', 'LSU', 'Louisville', 'Belmont', 'Maryland', 'Saint Louis'}, 'midwest': {'UNC', 'Ohio State', 'Houston', 'Georgia State', 'Northeastern', 'Washington', 'Seton Hall', 'Wofford', 'Auburn', 'Kentucky', 'Kansas', 'Iona', 'Abilene Christian', 'Iowa State', 'Utah State', 'New Mexico State'}, 'south': {'Virginia', 'UC-Irvine', "Saint Mary's", 'Gardner-Webb', 'Oregon', 'Cincinnati', 'Wisconsin', 'Old Dominion', 'Tennessee', 'Villanova', 'Purdue', 'Ole Miss', 'Colgate', 'Kansas State', 'Oklahoma', 'Iowa'}, 'west': {'Texas Tech', 'Gonzaga', 'Florida State', 'Northern Kentucky', 'Michigan', 'Nevada', 'Florida', 'Prairie View', 'Montana', 'Arizona State', 'Baylor', 'Fairleigh Dickinson', 'Buffalo', 'Marquette', 'Syracuse', "St. John's (NY)", 'Vermont', 'Murray State'}}, 2021: {'east': {'Texas', 'Colorado', 'Michigan', 'Florida State', "Mount St. Mary's", 'Alabama', 'UConn', 'Abilene Christian', 'Texas Southern', 'BYU', 'UCLA', 'Michigan State', 'UNC Greensboro', 'St. Bonaventure', 'Georgetown', 'LSU', 'Iona', 'Maryland'}, 'midwest': {'Houston', 'Illinois', 'Rutgers', 'Tennessee', 'San Diego State', 'Liberty', 'Oklahoma State', 'Clemson', 'Cleveland State', 'Syracuse', 'Morehead State', 'Drexel', 'Georgia Tech', 'Oregon State', 'Loyola (IL)', 'West Virginia'}, 'south': {'UNC', 'Ohio State', 'Texas Tech', 'Arkansas', 'Baylor', 'Winthrop', 'Wisconsin', 'Hartford', 'Oral Roberts', 'Virginia Tech', 'Purdue', 'Villanova', 'North Texas', 'Colgate', 'Florida', 'Utah State'}, 'west': {'Virginia', 'Oregon', 'VCU', 'Missouri', 'Gonzaga', 'UCSB', 'USC', 'Kansas', 'Iowa', 'Creighton', 'Eastern Washington', 'Drake', 'Grand Canyon', 'Ohio', 'Appalachian State', 'Wichita State', 'Norfolk State', 'Oklahoma'}}}
rename = {'UC-Davis':'UC Davis','UCF':'Central Florida', 'UCSB':'UC Santa Barbara','USC':'Southern California',
'UC-Irvine':'UC Irvine','UMBC':'Maryland-Baltimore County','UNC':'North Carolina','St. Joseph\'s':'Saint Joseph\'s',
'LSU':'Louisiana State','BYU':'Brigham Young','Pitt':'Pittsburgh','VCU':'Virginia Commonwealth',
'ETSU':'East Tennessee State','Ole Miss':'Mississippi','LIU':'Long Island University',
'SMU':'Southern Methodist','UConn':'Connecticut','Saint Mary\'s':'Saint Mary\'s (CA)',
'Penn':'Pennsylvania','UMass':'Massachusetts'}



df = pd.read_csv('./data/safe/2014-school-stats.csv')

# years_set = set()
# for year in years:
#     for region in years[year]:
#         years_set = years_set | years[year][region]

# schools = set(df['School'].tolist())
# final = schools ^ years_set

df2 = pd.DataFrame(columns=['School', 'Year', 'REGION'])

for year in years:
    for region in years[year]:
        for team in years[year][region]:
            if team in rename.keys():
                df2.loc[len(df2.index)] = [rename[team], year, region] 
            else:
                df2.loc[len(df2.index)] = [team, year, region]

for i in range(2014, 2022):
    if i != 2020:
        df = pd.read_csv('./data/safe/' + str(i) + '-school-stats.csv')

        df3 = pd.merge(df, df2.loc[df2['Year'] == i], how='outer', on='School').drop('Year', axis=1)
        df3['REGION'] = df3['REGION'].str.upper()

        df3.to_csv('./data/safe/' + str(i) + '-school-stats.csv', index=False)
        
